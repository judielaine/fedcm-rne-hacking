<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3140px" preserveAspectRatio="none" style="width:825px;height:3140px;background:#FFFFFF;" version="1.1" viewBox="0 0 825 3140" width="825px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.4883" id="_title" style="stroke:none;stroke-width:1.0;" width="281" x="273" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="271" x="278" y="28.5352">Basic SAML Authentication, no FedCM</text><rect fill="#DDDDDD" height="3090.9316" style="stroke:#181818;stroke-width:0.5;" width="300.5" x="26" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="160.75" y="56.0566">User</text><rect fill="#DDDDDD" height="3090.9316" style="stroke:#181818;stroke-width:0.5;" width="170.5" x="328.5" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="85" x="371.25" y="56.0566">research.org</text><rect fill="#FFFFFF" height="147.8633" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="154.5" y="2545.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="154.5" y1="2545.7422" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="164.5" y1="2545.7422" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="164.5" y1="2545.7422" y2="2545.7422"/><rect fill="#FFFFFF" height="57.3105" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="154.5" y="2734.5605"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="154.5" y1="2734.5605" y2="2791.8711"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="164.5" y1="2734.5605" y2="2791.8711"/><rect fill="#FFFFFF" height="96.5527" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="154.5" y="2832.8262"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="154.5" y1="2832.8262" y2="2929.3789"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="164.5" y1="2832.8262" y2="2929.3789"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="164.5" y1="2929.3789" y2="2929.3789"/><rect fill="#FFFFFF" height="187.9727" style="stroke:#181818;stroke-width:1.0;" width="10" x="283.5" y="427.3242"/><rect fill="#FFFFFF" height="43.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="283.5" y="1311.2578"/><rect fill="#FFFFFF" height="58.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="283.5" y="2516.7871"/><rect fill="#FFFFFF" height="89.2422" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="283.5" y="2604.3633"/><line style="stroke:#181818;stroke-width:1.0;" x1="283.5" x2="283.5" y1="2604.3633" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="293.5" x2="293.5" y1="2604.3633" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="283.5" x2="293.5" y1="2604.3633" y2="2604.3633"/><rect fill="#FFFFFF" height="57.3105" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="283.5" y="2734.5605"/><line style="stroke:#181818;stroke-width:1.0;" x1="283.5" x2="283.5" y1="2734.5605" y2="2791.8711"/><line style="stroke:#181818;stroke-width:1.0;" x1="293.5" x2="293.5" y1="2734.5605" y2="2791.8711"/><rect fill="#FFFFFF" height="51.9316" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="283.5" y="2832.8262"/><line style="stroke:#181818;stroke-width:1.0;" x1="283.5" x2="283.5" y1="2832.8262" y2="2884.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="293.5" x2="293.5" y1="2832.8262" y2="2884.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="283.5" x2="293.5" y1="2884.7578" y2="2884.7578"/><rect fill="#FFFFFF" height="1922.6348" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="474.5" y="770.9707"/><line style="stroke:#181818;stroke-width:1.0;" x1="474.5" x2="474.5" y1="770.9707" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="484.5" x2="484.5" y1="770.9707" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="474.5" x2="484.5" y1="770.9707" y2="770.9707"/><rect fill="#FFFFFF" height="57.3105" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="474.5" y="2734.5605"/><line style="stroke:#181818;stroke-width:1.0;" x1="474.5" x2="474.5" y1="2734.5605" y2="2791.8711"/><line style="stroke:#181818;stroke-width:1.0;" x1="484.5" x2="484.5" y1="2734.5605" y2="2791.8711"/><rect fill="#FFFFFF" height="258.1055" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="474.5" y="2832.8262"/><line style="stroke:#181818;stroke-width:1.0;" x1="474.5" x2="474.5" y1="2832.8262" y2="3090.9316"/><line style="stroke:#181818;stroke-width:1.0;" x1="484.5" x2="484.5" y1="2832.8262" y2="3090.9316"/><rect fill="#FFFFFF" height="1740.0293" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="623.5" y="953.5762"/><line style="stroke:#181818;stroke-width:1.0;" x1="623.5" x2="623.5" y1="953.5762" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="633.5" x2="633.5" y1="953.5762" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="623.5" x2="633.5" y1="953.5762" y2="953.5762"/><rect fill="#FFFFFF" height="57.3105" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="623.5" y="2734.5605"/><line style="stroke:#181818;stroke-width:1.0;" x1="623.5" x2="623.5" y1="2734.5605" y2="2791.8711"/><line style="stroke:#181818;stroke-width:1.0;" x1="633.5" x2="633.5" y1="2734.5605" y2="2791.8711"/><rect fill="#FFFFFF" height="258.1055" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="623.5" y="2832.8262"/><line style="stroke:#181818;stroke-width:1.0;" x1="623.5" x2="623.5" y1="2832.8262" y2="3090.9316"/><line style="stroke:#181818;stroke-width:1.0;" x1="633.5" x2="633.5" y1="2832.8262" y2="3090.9316"/><rect fill="none" height="150.1738" style="stroke:#000000;stroke-width:1.5;" width="451.5" x="115" y="185.2188"/><rect fill="none" height="303.2148" style="stroke:#000000;stroke-width:1.5;" width="642" x="20" y="349.3926"/><rect fill="none" height="294.9688" style="stroke:#000000;stroke-width:1.5;" width="586" x="81" y="666.6074"/><rect fill="none" height="172.1738" style="stroke:#000000;stroke-width:1.5;" width="643" x="69" y="975.5762"/><rect fill="none" height="74.9316" style="stroke:#000000;stroke-width:1.5;" width="522" x="180" y="1065.8184"/><rect fill="none" height="519.2129" style="stroke:#000000;stroke-width:1.5;" width="808" x="10" y="1161.75"/><rect fill="none" height="348.3945" style="stroke:#000000;stroke-width:1.5;" width="788" x="20" y="1186.0605"/><rect fill="none" height="116.8867" style="stroke:#000000;stroke-width:1.5;" width="208" x="590" y="1410.5684"/><rect fill="none" height="253.3711" style="stroke:#000000;stroke-width:1.5;" width="552" x="115" y="1768.8945"/><rect fill="none" height="794.9395" style="stroke:#000000;stroke-width:1.5;" width="647" x="20" y="2287.9922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="53" x2="53" y1="94.2871" y2="2693.6055"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="53" x2="53" y1="2693.6055" y2="2734.5605"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="53" x2="53" y1="2734.5605" y2="2791.8711"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="53" x2="53" y1="2791.8711" y2="2832.8262"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="53" x2="53" y1="2832.8262" y2="3099.9316"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="159" x2="159" y1="94.2871" y2="2693.6055"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="159" x2="159" y1="2693.6055" y2="2734.5605"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="159" x2="159" y1="2734.5605" y2="2791.8711"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="159" x2="159" y1="2791.8711" y2="2832.8262"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="159" x2="159" y1="2832.8262" y2="3099.9316"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="288.5" x2="288.5" y1="442.0684" y2="2693.6055"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="288.5" x2="288.5" y1="2693.6055" y2="2734.5605"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="288.5" x2="288.5" y1="2734.5605" y2="2791.8711"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="288.5" x2="288.5" y1="2791.8711" y2="2832.8262"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="288.5" x2="288.5" y1="2832.8262" y2="3099.9316"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="353.5" x2="353.5" y1="94.2871" y2="2693.6055"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="353.5" x2="353.5" y1="2693.6055" y2="2734.5605"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="353.5" x2="353.5" y1="2734.5605" y2="2791.8711"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="353.5" x2="353.5" y1="2791.8711" y2="2832.8262"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="353.5" x2="353.5" y1="2832.8262" y2="3099.9316"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="479" x2="479" y1="94.2871" y2="2693.6055"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="479" x2="479" y1="2693.6055" y2="2734.5605"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="479" x2="479" y1="2734.5605" y2="2791.8711"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="479" x2="479" y1="2791.8711" y2="2832.8262"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="479" x2="479" y1="2832.8262" y2="3099.9316"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="561" x2="561" y1="94.2871" y2="2693.6055"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="561" x2="561" y1="2693.6055" y2="2734.5605"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="561" x2="561" y1="2734.5605" y2="2791.8711"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="561" x2="561" y1="2791.8711" y2="2832.8262"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="561" x2="561" y1="2832.8262" y2="3099.9316"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="628" x2="628" y1="94.2871" y2="2693.6055"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="628" x2="628" y1="2693.6055" y2="2734.5605"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="628" x2="628" y1="2734.5605" y2="2791.8711"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="628" x2="628" y1="2791.8711" y2="2832.8262"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="628" x2="628" y1="2832.8262" y2="3099.9316"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47" x="30" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="37" y="83.334">Alice</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47" x="30" y="3098.9316"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="37" y="3119.4668">Alice</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="125" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="132" y="83.334">Browser</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="125" y="3098.9316"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="132" y="3119.4668">Browser</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="254.5" y="3098.9316"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="261.5" y="3119.4668">Window</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42" x="332.5" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="339.5" y="83.334">Wiki</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42" x="332.5" y="3098.9316"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="339.5" y="3119.4668">Wiki</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="31" x="464" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="17" x="471" y="83.334">RP</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="31" x="464" y="3098.9316"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="17" x="471" y="3119.4668">RP</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="533" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="540" y="83.334">IdP 01</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="533" y="3098.9316"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="540" y="3119.4668">IdP 01</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="600" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="607" y="83.334">IdP 02</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="600" y="3098.9316"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="607" y="3119.4668">IdP 02</text><rect fill="#FFFFFF" height="147.8633" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="154.5" y="2545.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="154.5" y1="2545.7422" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="164.5" y1="2545.7422" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="164.5" y1="2545.7422" y2="2545.7422"/><rect fill="#FFFFFF" height="57.3105" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="154.5" y="2734.5605"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="154.5" y1="2734.5605" y2="2791.8711"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="164.5" y1="2734.5605" y2="2791.8711"/><rect fill="#FFFFFF" height="96.5527" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="154.5" y="2832.8262"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="154.5" y1="2832.8262" y2="2929.3789"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="164.5" y1="2832.8262" y2="2929.3789"/><line style="stroke:#181818;stroke-width:1.0;" x1="154.5" x2="164.5" y1="2929.3789" y2="2929.3789"/><rect fill="#FFFFFF" height="187.9727" style="stroke:#181818;stroke-width:1.0;" width="10" x="283.5" y="427.3242"/><rect fill="#FFFFFF" height="43.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="283.5" y="1311.2578"/><rect fill="#FFFFFF" height="58.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="283.5" y="2516.7871"/><rect fill="#FFFFFF" height="89.2422" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="283.5" y="2604.3633"/><line style="stroke:#181818;stroke-width:1.0;" x1="283.5" x2="283.5" y1="2604.3633" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="293.5" x2="293.5" y1="2604.3633" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="283.5" x2="293.5" y1="2604.3633" y2="2604.3633"/><rect fill="#FFFFFF" height="57.3105" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="283.5" y="2734.5605"/><line style="stroke:#181818;stroke-width:1.0;" x1="283.5" x2="283.5" y1="2734.5605" y2="2791.8711"/><line style="stroke:#181818;stroke-width:1.0;" x1="293.5" x2="293.5" y1="2734.5605" y2="2791.8711"/><rect fill="#FFFFFF" height="51.9316" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="283.5" y="2832.8262"/><line style="stroke:#181818;stroke-width:1.0;" x1="283.5" x2="283.5" y1="2832.8262" y2="2884.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="293.5" x2="293.5" y1="2832.8262" y2="2884.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="283.5" x2="293.5" y1="2884.7578" y2="2884.7578"/><rect fill="#FFFFFF" height="1922.6348" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="474.5" y="770.9707"/><line style="stroke:#181818;stroke-width:1.0;" x1="474.5" x2="474.5" y1="770.9707" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="484.5" x2="484.5" y1="770.9707" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="474.5" x2="484.5" y1="770.9707" y2="770.9707"/><rect fill="#FFFFFF" height="57.3105" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="474.5" y="2734.5605"/><line style="stroke:#181818;stroke-width:1.0;" x1="474.5" x2="474.5" y1="2734.5605" y2="2791.8711"/><line style="stroke:#181818;stroke-width:1.0;" x1="484.5" x2="484.5" y1="2734.5605" y2="2791.8711"/><rect fill="#FFFFFF" height="258.1055" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="474.5" y="2832.8262"/><line style="stroke:#181818;stroke-width:1.0;" x1="474.5" x2="474.5" y1="2832.8262" y2="3090.9316"/><line style="stroke:#181818;stroke-width:1.0;" x1="484.5" x2="484.5" y1="2832.8262" y2="3090.9316"/><rect fill="#FFFFFF" height="1740.0293" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="623.5" y="953.5762"/><line style="stroke:#181818;stroke-width:1.0;" x1="623.5" x2="623.5" y1="953.5762" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="633.5" x2="633.5" y1="953.5762" y2="2693.6055"/><line style="stroke:#181818;stroke-width:1.0;" x1="623.5" x2="633.5" y1="953.5762" y2="953.5762"/><rect fill="#FFFFFF" height="57.3105" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="623.5" y="2734.5605"/><line style="stroke:#181818;stroke-width:1.0;" x1="623.5" x2="623.5" y1="2734.5605" y2="2791.8711"/><line style="stroke:#181818;stroke-width:1.0;" x1="633.5" x2="633.5" y1="2734.5605" y2="2791.8711"/><rect fill="#FFFFFF" height="258.1055" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="623.5" y="2832.8262"/><line style="stroke:#181818;stroke-width:1.0;" x1="623.5" x2="623.5" y1="2832.8262" y2="3090.9316"/><line style="stroke:#181818;stroke-width:1.0;" x1="633.5" x2="633.5" y1="2832.8262" y2="3090.9316"/><polygon fill="#181818" points="147.5,136.9082,157.5,140.9082,147.5,144.9082,151.5,140.9082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="53.5" x2="153.5" y1="140.9082" y2="140.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="60.5" y="120.8555">go wiki.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="60.5" y="136.166">resource.org</text><polygon fill="#181818" points="170.5,166.2188,160.5,170.2188,170.5,174.2188,166.5,170.2188" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="341.5,166.2188,351.5,170.2188,341.5,174.2188,345.5,170.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="347.5" y1="170.2188" y2="170.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="176.5" y="165.4766">response 302</text><path d="M115,185.2188 L302,185.2188 L302,192.5293 L292,202.5293 L115,202.5293 L115,185.2188 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="150.1738" style="stroke:#000000;stroke-width:1.5;" width="451.5" x="115" y="185.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="142" x="130" y="198.7871">SAML Profile §4.1.3.1</text><polygon fill="#181818" points="467.5,219.8398,477.5,223.8398,467.5,227.8398,471.5,223.8398" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="473.5" y1="223.8398" y2="223.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="166.5" y="219.0977">GET RP</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="479.5" x2="521.5" y1="314.3926" y2="314.3926"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="521.5" x2="521.5" y1="314.3926" y2="327.3926"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="480.5" x2="521.5" y1="327.3926" y2="327.3926"/><polygon fill="#181818" points="490.5,323.3926,480.5,327.3926,490.5,331.3926,486.5,327.3926" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="486.5" y="248.4082">No active</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="486.5" y="263.7188">SSO state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="486.5" y="279.0293">found.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19" x="486.5" y="294.3398">Set</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="486.5" y="309.6504">RelayState.</text><path d="M20,349.3926 L207,349.3926 L207,356.7031 L197,366.7031 L20,366.7031 L20,349.3926 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="303.2148" style="stroke:#000000;stroke-width:1.5;" width="642" x="20" y="349.3926"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="142" x="35" y="362.9609">SAML Profile §4.1.3.2</text><polygon fill="#181818" points="170.5,399.3242,160.5,403.3242,170.5,407.3242,166.5,403.3242" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="478.5" y1="403.3242" y2="403.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="176.5" y="383.2715">HTML for RP UI;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="176.5" y="398.582">session cookie</text><polygon fill="#181818" points="242.5,413.3242,252.5,417.3242,242.5,421.3242,246.5,417.3242" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159.5" x2="248.5" y1="417.3242" y2="417.3242"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="254.5" y="411.3242"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="261.5" y="431.8594">Window</text><path d="M30,457.8125 L30,574.8125 L652,574.8125 L652,467.8125 L642,457.8125 L30,457.8125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M642,457.8125 L642,467.8125 L652,467.8125 L642,457.8125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="527" x="65" y="475.3809">The RP presents the user with a list of possible identity providers. OCLC has 30,000</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="543" x="65" y="490.6914">customers in our WAYF (with a variety of IdP protocols). eduGAIN has 5269 SAML IdPs.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="65" y="506.002"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="427" x="65" y="521.3125">Seamless Access provides a solution here for a variety of use cases.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="65" y="536.623"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="479" x="65" y="551.9336">SAML Profile §4.1.3.2 does not cover how this is done, but notes **proxying</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="455" x="65" y="567.2441">authentication requests**, which is done. See also [SDP-SP20,SDP-SP23]</text><polygon fill="#181818" points="271.5,597.2969,281.5,601.2969,271.5,605.2969,275.5,601.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="53.5" x2="277.5" y1="601.2969" y2="601.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="60.5" y="596.5547">select IdP</text><polygon fill="#181818" points="170.5,611.2969,160.5,615.2969,170.5,619.2969,166.5,615.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="164.5" x2="287.5" y1="615.2969" y2="615.2969"/><line style="stroke:#A80036;stroke-width:2.0;" x1="279.5" x2="297.5" y1="606.2969" y2="624.2969"/><line style="stroke:#A80036;stroke-width:2.0;" x1="279.5" x2="297.5" y1="624.2969" y2="606.2969"/><polygon fill="#181818" points="467.5,640.6074,477.5,644.6074,467.5,648.6074,471.5,644.6074" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="473.5" y1="644.6074" y2="644.6074"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="166.5" y="639.8652">choice of IdP02</text><path d="M81,666.6074 L432,666.6074 L432,673.918 L422,683.918 L81,683.918 L81,666.6074 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="294.9688" style="stroke:#000000;stroke-width:1.5;" width="586" x="81" y="666.6074"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="306" x="96" y="680.1758">SAML Profile §4.1.3.3 and SAML Core §4.1.3.3</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="479.5" x2="526.5" y1="757.9707" y2="757.9707"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="526.5" x2="526.5" y1="757.9707" y2="770.9707"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="485.5" x2="526.5" y1="770.9707" y2="770.9707"/><polygon fill="#181818" points="495.5,766.9707,485.5,770.9707,495.5,774.9707,491.5,770.9707" style="stroke:#181818;stroke-width:1.0;"/><path d="M91,688.918 L91,851.918 L469,851.918 L469,698.918 L459,688.918 L91,688.918 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M459,688.918 L459,698.918 L469,698.918 L459,688.918 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="97" y="706.4863">Construct SAML Request:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="307" x="97" y="721.7969">1. Issuer's unique entity ID (URI), plus return URL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="113" y="737.1074">(AssertionConsumerServiceURL);</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353" x="97" y="752.418">3. optional &lt;AuthnRequest&gt;, for example to signal MFA</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="113" y="767.7285">[SDP-SP07], or ForceAuthn,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="97" y="783.0391">4. Security elements:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="113" y="798.3496">time stamp</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="113" y="813.6602">unique ID (persist)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="113" y="828.9707">optional signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="97" y="844.2813">5. IdP's SSO destination</text><polygon fill="#181818" points="170.5,904.9551,160.5,908.9551,170.5,912.9551,166.5,908.9551" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="473.5" y1="908.9551" y2="908.9551"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291" x="176.5" y="873.5918">302 GET idp.edu/sso??SAMLRequest=[request]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="176.5" y="888.9023">see [SDP-SP02]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="176.5" y="904.2129">see also saml-bindings-2.0-os §3.4</text><polygon fill="#181818" points="611.5,949.5762,621.5,953.5762,611.5,957.5762,615.5,953.5762" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="617.5" y1="953.5762" y2="953.5762"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263" x="166.5" y="933.5234">GET idp.edu/sso??SAMLRequest=[request]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="166.5" y="948.834">with idp.edu cookies</text><path d="M69,975.5762 L225,975.5762 L225,982.8867 L215,992.8867 L69,992.8867 L69,975.5762 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="172.1738" style="stroke:#000000;stroke-width:1.5;" width="643" x="69" y="975.5762"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="84" y="989.1445">Validate request</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="633.5" x2="675.5" y1="1026.0078" y2="1026.0078"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="675.5" x2="675.5" y1="1026.0078" y2="1039.0078"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634.5" x2="675.5" y1="1039.0078" y2="1039.0078"/><polygon fill="#181818" points="644.5,1035.0078,634.5,1039.0078,644.5,1043.0078,640.5,1039.0078" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="640.5" y="1021.2656">validate</text><path d="M79,997.8867 L79,1052.8867 L618,1052.8867 L618,1007.8867 L608,997.8867 L79,997.8867 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M608,997.8867 L608,1007.8867 L618,1007.8867 L608,997.8867 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="514" x="85" y="1015.4551">Minimally ensure SO known and ACS acceptable. Also evaluate whether assurance</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="473" x="85" y="1030.7656">requests (and any other supported requests) can be honored. Identify steps</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233" x="85" y="1046.0762">required for identifying the principal.</text><path d="M180,1065.8184 L242,1065.8184 L242,1073.1289 L232,1083.1289 L180,1083.1289 L180,1065.8184 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="74.9316" style="stroke:#000000;stroke-width:1.5;" width="522" x="180" y="1065.8184"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="195" y="1079.3867">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="160" x="257" y="1078.4531">[Request cannot be honored]</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="633.5" x2="675.5" y1="1119.75" y2="1119.75"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="675.5" x2="675.5" y1="1119.75" y2="1132.75"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634.5" x2="675.5" y1="1132.75" y2="1132.75"/><polygon fill="#181818" points="644.5,1128.75,634.5,1132.75,644.5,1136.75,640.5,1132.75" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="640.5" y="1099.6973">construct</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="640.5" y="1115.0078">response</text><path d="M190,1091.6289 L190,1131.6289 L618,1131.6289 L618,1101.6289 L608,1091.6289 L190,1091.6289 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M608,1091.6289 L608,1101.6289 L618,1101.6289 L608,1091.6289 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="378" x="196" y="1109.1973">Construct error response, including the request's unique ID.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="407" x="196" y="1124.5078">Error should allow SO to assist user in understanding the failure.</text><path d="M10,1161.75 L197,1161.75 L197,1169.0605 L187,1179.0605 L10,1179.0605 L10,1161.75 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="519.2129" style="stroke:#000000;stroke-width:1.5;" width="808" x="10" y="1161.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="142" x="25" y="1175.3184">SAML Profile §4.1.3.4</text><path d="M20,1186.0605 L82,1186.0605 L82,1193.3711 L72,1203.3711 L20,1203.3711 L20,1186.0605 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="348.3945" style="stroke:#000000;stroke-width:1.5;" width="788" x="20" y="1186.0605"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="35" y="1199.6289">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="188" x="97" y="1198.6953">[Existing SSO state, no assurance]</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="633.5" x2="675.5" y1="1239.9922" y2="1239.9922"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="675.5" x2="675.5" y1="1239.9922" y2="1252.9922"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634.5" x2="675.5" y1="1252.9922" y2="1252.9922"/><polygon fill="#181818" points="644.5,1248.9922,634.5,1252.9922,644.5,1256.9922,640.5,1252.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="640.5" y="1219.9395">construct</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="640.5" y="1235.25">response</text><path d="M190,1211.8711 L190,1251.8711 L618,1251.8711 L618,1221.8711 L608,1211.8711 L190,1211.8711 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M608,1211.8711 L608,1221.8711 L618,1221.8711 L608,1211.8711 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403" x="196" y="1229.4395">Construct response as below, including the request's unique ID.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="407" x="196" y="1244.75">Error should allow SO to assist user in understanding the failure.</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="808" y1="1261.9922" y2="1261.9922"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="206" x="25" y="1272.627">[Existing SSO but ForceAuthn = true]</text><polygon fill="#181818" points="170.5,1293.2578,160.5,1297.2578,170.5,1301.2578,166.5,1297.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="622.5" y1="1297.2578" y2="1297.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="176.5" y="1292.5156">challenge</text><polygon fill="#181818" points="271.5,1307.2578,281.5,1311.2578,271.5,1315.2578,275.5,1311.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="277.5" y1="1311.2578" y2="1311.2578"/><polygon fill="#181818" points="271.5,1336.5684,281.5,1340.5684,271.5,1344.5684,275.5,1340.5684" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="53.5" x2="277.5" y1="1340.5684" y2="1340.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="60.5" y="1335.8262">respond</text><polygon fill="#181818" points="170.5,1350.5684,160.5,1354.5684,170.5,1358.5684,166.5,1354.5684" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="287.5" y1="1354.5684" y2="1354.5684"/><line style="stroke:#A80036;stroke-width:2.0;" x1="279.5" x2="297.5" y1="1345.5684" y2="1363.5684"/><line style="stroke:#A80036;stroke-width:2.0;" x1="279.5" x2="297.5" y1="1363.5684" y2="1345.5684"/><polygon fill="#181818" points="611.5,1364.5684,621.5,1368.5684,611.5,1372.5684,615.5,1368.5684" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="617.5" y1="1368.5684" y2="1368.5684"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="633.5" x2="675.5" y1="1382.5684" y2="1382.5684"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="675.5" x2="675.5" y1="1382.5684" y2="1395.5684"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634.5" x2="675.5" y1="1395.5684" y2="1395.5684"/><polygon fill="#181818" points="644.5,1391.5684,634.5,1395.5684,644.5,1399.5684,640.5,1395.5684" style="stroke:#181818;stroke-width:1.0;"/><path d="M590,1410.5684 L652,1410.5684 L652,1417.8789 L642,1427.8789 L590,1427.8789 L590,1410.5684 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="116.8867" style="stroke:#000000;stroke-width:1.5;" width="208" x="590" y="1410.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="605" y="1424.1367">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="126" x="667" y="1423.2031">[Challenge successful]</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="633.5" x2="675.5" y1="1449.1895" y2="1449.1895"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="675.5" x2="675.5" y1="1449.1895" y2="1462.1895"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634.5" x2="675.5" y1="1462.1895" y2="1462.1895"/><polygon fill="#181818" points="644.5,1458.1895,634.5,1462.1895,644.5,1466.1895,640.5,1462.1895" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="640.5" y="1444.4473">response as elsewhere</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="590" x2="798" y1="1471.1895" y2="1471.1895"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="92" x="595" y="1481.8242">[Challenge fails]</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="633.5" x2="675.5" y1="1506.4551" y2="1506.4551"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="675.5" x2="675.5" y1="1506.4551" y2="1519.4551"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634.5" x2="675.5" y1="1519.4551" y2="1519.4551"/><polygon fill="#181818" points="644.5,1515.4551,634.5,1519.4551,644.5,1523.4551,640.5,1519.4551" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="640.5" y="1501.7129">error</text><polygon fill="#181818" points="170.5,1558.7656,160.5,1562.7656,170.5,1566.7656,166.5,1562.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="622.5" y1="1562.7656" y2="1562.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="176.5" y="1558.0234">Single Account Label</text><path d="M130,1575.7656 L130,1630.7656 L657,1630.7656 L657,1585.7656 L647,1575.7656 L130,1575.7656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M647,1575.7656 L647,1585.7656 L657,1585.7656 L647,1575.7656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275" x="250" y="1593.334">SAML IdPs would not expose more than one</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274" x="250" y="1608.6445">account at a time. The label for the account</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="250" y="1623.9551">may not be an email.</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="818" y1="1637.6973" y2="1637.6973"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="223" x="15" y="1648.332">[Assume no existing SSO state at IdP02]</text><polygon fill="#181818" points="170.5,1668.9629,160.5,1672.9629,170.5,1676.9629,166.5,1672.9629" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="622.5" y1="1672.9629" y2="1672.9629"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="176.5" y="1668.2207">request to initiate authN</text><polygon fill="#181818" points="170.5,1705.2734,160.5,1709.2734,170.5,1713.2734,166.5,1709.2734" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="549.5,1705.2734,559.5,1709.2734,549.5,1713.2734,553.5,1709.2734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="555.5" y1="1709.2734" y2="1709.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="176.5" y="1704.5313">GET client?....</text><polygon fill="#181818" points="611.5,1749.8945,621.5,1753.8945,611.5,1757.8945,615.5,1753.8945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="617.5" y1="1753.8945" y2="1753.8945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="166.5" y="1733.8418">GET client?client_id=[entityId]&amp;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="166.5" y="1749.1523">SAML_request=[req]</text><path d="M115,1768.8945 L177,1768.8945 L177,1776.2051 L167,1786.2051 L115,1786.2051 L115,1768.8945 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="253.3711" style="stroke:#000000;stroke-width:1.5;" width="552" x="115" y="1768.8945"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="130" y="1782.4629">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="157" x="192" y="1781.5293">[Assume IdP recognizes RP]</text><polygon fill="#181818" points="170.5,1803.5156,160.5,1807.5156,170.5,1811.5156,166.5,1807.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="622.5" y1="1807.5156" y2="1807.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="176.5" y="1802.7734">metadata about IdP-RP interaction</text><path d="M130,1820.5156 L130,1906.5156 L657,1906.5156 L657,1830.5156 L647,1820.5156 L130,1820.5156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M647,1820.5156 L647,1830.5156 L657,1830.5156 L647,1820.5156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276" x="224" y="1838.084">Note that the RP's request might require the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="322" x="224" y="1853.3945">browser to step up an already active authentication</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293" x="224" y="1868.7051">state to improve the authentication assurance.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="330" x="224" y="1884.0156">The response here would include a message that the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="307" x="224" y="1899.3262">IdP needs control before authenticating the user.</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="115" x2="667" y1="1913.0684" y2="1913.0684"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="172" x="120" y="1923.7031">[IdP cannot satisfy RP request]</text><polygon fill="#181818" points="170.5,1944.334,160.5,1948.334,170.5,1952.334,166.5,1948.334" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="622.5" y1="1948.334" y2="1948.334"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="176.5" y="1943.5918">Error code, Error message for user</text><path d="M130,1961.334 L130,2016.334 L657,2016.334 L657,1971.334 L647,1961.334 L130,1961.334 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M647,1961.334 L647,1971.334 L657,1971.334 L647,1961.334 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="312" x="231.5" y="1978.9023">An IdP might not recognize an RP at all, or the IdP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="311" x="231.5" y="1994.2129">might not be able to satisfy criteria in the current</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="231.5" y="2009.5234">RP request.</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159.5" x2="201.5" y1="2108.3184" y2="2108.3184"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="201.5" x2="201.5" y1="2108.3184" y2="2121.3184"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="160.5" x2="201.5" y1="2121.3184" y2="2121.3184"/><polygon fill="#181818" points="170.5,2117.3184,160.5,2121.3184,170.5,2125.3184,166.5,2121.3184" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="166.5" y="2103.5762">IdP chooser</text><path d="M251,2034.2656 L251,2181.2656 L522,2181.2656 L522,2044.2656 L512,2034.2656 L251,2034.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M512,2034.2656 L512,2044.2656 L522,2044.2656 L512,2034.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="257" y="2051.834">Assume UI presents the two previously</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="257" y="2067.1445">registered with a link to choose a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215" x="257" y="2082.4551">different one. If there was an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="257" y="2097.7656">message for a previously registered</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="257" y="2113.0762">IdP, display to the user, but do not</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="257" y="2128.3867">allow selection.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="257" y="2143.6973"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="250" x="257" y="2159.0078">Assume choice between IdP 01 &amp; IdP 02</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="257" y="2174.3184">or select from more.</text><polygon fill="#181818" points="147.5,2204.3711,157.5,2208.3711,147.5,2212.3711,151.5,2208.3711" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="53.5" x2="153.5" y1="2208.3711" y2="2208.3711"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="60.5" y="2203.6289">select IDP 02</text><polygon fill="#181818" points="611.5,2233.6816,621.5,2237.6816,611.5,2241.6816,615.5,2237.6816" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="617.5" y1="2237.6816" y2="2237.6816"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="166.5" y="2232.9395">cookies; POST assertion</text><path d="M130,2250.6816 L130,2275.6816 L657,2275.6816 L657,2260.6816 L647,2250.6816 L130,2250.6816 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M647,2250.6816 L647,2260.6816 L657,2260.6816 L647,2250.6816 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="316.5" y="2268.25">Includes SAMLRequest</text><path d="M20,2287.9922 L82,2287.9922 L82,2295.3027 L72,2305.3027 L20,2305.3027 L20,2287.9922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="794.9395" style="stroke:#000000;stroke-width:1.5;" width="647" x="20" y="2287.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="35" y="2301.5605">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="210" x="97" y="2300.627">[Assume active SSO stete, no step up]</text><polygon fill="#181818" points="170.5,2322.6133,160.5,2326.6133,170.5,2330.6133,166.5,2326.6133" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="622.5" y1="2326.6133" y2="2326.6133"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="176.5" y="2321.8711">LARGE XML response, encoded, etc</text><line style="stroke:#A80036;stroke-width:2.0;" x1="279.5" x2="297.5" y1="2317.6133" y2="2335.6133"/><line style="stroke:#A80036;stroke-width:2.0;" x1="279.5" x2="297.5" y1="2335.6133" y2="2317.6133"/><polygon fill="#181818" points="462.5,2367.2344,472.5,2371.2344,462.5,2375.2344,466.5,2371.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="468.5" y1="2371.2344" y2="2371.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="166.5" y="2351.1816">response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="166.5" y="2366.4922">session cookie</text><line style="stroke:#A80036;stroke-width:2.0;" x1="150.5" x2="168.5" y1="2362.2344" y2="2380.2344"/><line style="stroke:#A80036;stroke-width:2.0;" x1="150.5" x2="168.5" y1="2380.2344" y2="2362.2344"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="484.5" x2="526.5" y1="2415.8555" y2="2415.8555"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="526.5" x2="526.5" y1="2415.8555" y2="2428.8555"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="485.5" x2="526.5" y1="2428.8555" y2="2428.8555"/><polygon fill="#181818" points="495.5,2424.8555,485.5,2428.8555,495.5,2432.8555,491.5,2428.8555" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="491.5" y="2395.8027">establish</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="491.5" y="2411.1133">session</text><polygon fill="#181818" points="170.5,2454.166,160.5,2458.166,170.5,2462.166,166.5,2458.166" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="473.5" y1="2458.166" y2="2458.166"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24" x="176.5" y="2453.4238">302</text><polygon fill="#181818" points="170.5,2483.4766,160.5,2487.4766,170.5,2491.4766,166.5,2487.4766" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="341.5,2483.4766,351.5,2487.4766,341.5,2491.4766,345.5,2487.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="347.5" y1="2487.4766" y2="2487.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="176.5" y="2482.7344">GET wiki</text><polygon fill="#181818" points="271.5,2512.7871,281.5,2516.7871,271.5,2520.7871,275.5,2516.7871" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159.5" x2="277.5" y1="2516.7871" y2="2516.7871"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="166.5" y="2512.0449">render wiki</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="667" y1="2525.7871" y2="2525.7871"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="169" x="25" y="2536.4219">[Assume IdP requests control]</text><polygon fill="#181818" points="142.5,2541.7422,152.5,2545.7422,142.5,2549.7422,146.5,2545.7422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="0" x2="148.5" y1="2545.7422" y2="2545.7422"/><polygon fill="#181818" points="175.5,2571.0527,165.5,2575.0527,175.5,2579.0527,171.5,2575.0527" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="169.5" x2="622.5" y1="2575.0527" y2="2575.0527"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="181.5" y="2570.3105">HTML</text><line style="stroke:#A80036;stroke-width:2.0;" x1="279.5" x2="297.5" y1="2566.0527" y2="2584.0527"/><line style="stroke:#A80036;stroke-width:2.0;" x1="279.5" x2="297.5" y1="2584.0527" y2="2566.0527"/><polygon fill="#181818" points="271.5,2600.3633,281.5,2604.3633,271.5,2608.3633,275.5,2604.3633" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="277.5" y1="2604.3633" y2="2604.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="171.5" y="2599.6211">Render IdP page</text><path d="M130,2617.3633 L130,2688.3633 L657,2688.3633 L657,2627.3633 L647,2617.3633 L130,2617.3633 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M647,2617.3633 L647,2627.3633 L657,2627.3633 L647,2617.3633 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331" x="219" y="2634.9316">There may be multiple POSTS here, particularly given</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340" x="219" y="2650.2422">multiple factors to establish identity. It is conceivable</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="313" x="219" y="2665.5527">that this flow may spawn a second authentication</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="219" y="2680.8633">flow.</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="65" x="308.5" y="2718.2402">iterations of</text><polygon fill="#181818" points="271.5,2751.8711,281.5,2755.8711,271.5,2759.8711,275.5,2755.8711" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="53.5" x2="277.5" y1="2755.8711" y2="2755.8711"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="60.5" y="2751.1289">interaction</text><polygon fill="#181818" points="175.5,2765.8711,165.5,2769.8711,175.5,2773.8711,171.5,2769.8711" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="169.5" x2="282.5" y1="2769.8711" y2="2769.8711"/><polygon fill="#181818" points="175.5,2779.8711,165.5,2783.8711,175.5,2787.8711,171.5,2783.8711" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="611.5,2779.8711,621.5,2783.8711,611.5,2787.8711,615.5,2783.8711" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="169.5" x2="617.5" y1="2783.8711" y2="2783.8711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="54" x="314" y="2816.5059">eventually</text><polygon fill="#FF0000" points="175.5,2880.7578,165.5,2884.7578,175.5,2888.7578,171.5,2884.7578" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="169.5" x2="287.5" y1="2884.7578" y2="2884.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="181.5" y="2849.3945">n.c.post</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="181.5" y="2864.7051">(LARGE XML</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="181.5" y="2880.0156">response)</text><line style="stroke:#A80036;stroke-width:2.0;" x1="279.5" x2="297.5" y1="2875.7578" y2="2893.7578"/><line style="stroke:#A80036;stroke-width:2.0;" x1="279.5" x2="297.5" y1="2893.7578" y2="2875.7578"/><polygon fill="#181818" points="462.5,2925.3789,472.5,2929.3789,462.5,2933.3789,466.5,2929.3789" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="468.5" y1="2929.3789" y2="2929.3789"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="166.5" y="2909.3262">response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="166.5" y="2924.6367">session cookie</text><line style="stroke:#A80036;stroke-width:2.0;" x1="150.5" x2="168.5" y1="2920.3789" y2="2938.3789"/><line style="stroke:#A80036;stroke-width:2.0;" x1="150.5" x2="168.5" y1="2938.3789" y2="2920.3789"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="484.5" x2="526.5" y1="2974" y2="2974"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="526.5" x2="526.5" y1="2974" y2="2987"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="485.5" x2="526.5" y1="2987" y2="2987"/><polygon fill="#181818" points="495.5,2983,485.5,2987,495.5,2991,491.5,2987" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="491.5" y="2953.9473">establish</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="491.5" y="2969.2578">session</text><polygon fill="#181818" points="170.5,3012.3105,160.5,3016.3105,170.5,3020.3105,166.5,3016.3105" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="473.5" y1="3016.3105" y2="3016.3105"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24" x="176.5" y="3011.5684">302</text><polygon fill="#181818" points="170.5,3041.6211,160.5,3045.6211,170.5,3049.6211,166.5,3045.6211" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="341.5,3041.6211,351.5,3045.6211,341.5,3049.6211,345.5,3045.6211" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164.5" x2="347.5" y1="3045.6211" y2="3045.6211"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="176.5" y="3040.8789">GET wiki</text><polygon fill="#181818" points="271.5,3070.9316,281.5,3074.9316,271.5,3078.9316,275.5,3074.9316" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159.5" x2="277.5" y1="3074.9316" y2="3074.9316"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="166.5" y="3070.1895">render wiki</text><!--MD5=[5e0babbe4f69c821b07ad181058d465a]
@startuml BasicSAML

title "Basic SAML Authentication, no FedCM"

box User
    participant Alice
    participant Browser
    participant "Window" as window
end box

box research.org
    participant Wiki
    participant RP
end box

participant "IdP 01" as IdP01
participant "IdP 02" as IdP02

Alice - -> Browser: go wiki.\nresource.org
Browser  <-> Wiki: response 302 

group SAML Profile §4.1.3.1
    Browser -> RP: GET RP
    RP - -> RP: No active\nSSO state\nfound.\nSet\nRelayState.
end group
group SAML Profile §4.1.3.2
    RP -> Browser: HTML for RP UI;\nsession cookie
    Browser - -> window **
    activate window 
    note over Alice, IdP02
        The RP presents the user with a list of possible identity providers. OCLC has 30,000 
        customers in our WAYF (with a variety of IdP protocols). eduGAIN has 5269 SAML IdPs.
        
        Seamless Access provides a solution here for a variety of use cases.
        
        SAML Profile §4.1.3.2 does not cover how this is done, but notes **proxying 
        authentication requests**, which is done. See also [SDP-SP20,SDP-SP23]
    end note
    Alice - -> window: select IdP
    window - -> Browser 
    destroy window
    Browser -> RP: choice of IdP02
end group
group SAML Profile §4.1.3.3 and SAML Core §4.1.3.3
    RP - -> RP  
    note left
        Construct SAML Request:
        1. Issuer's unique entity ID (URI), plus return URL 
            (AssertionConsumerServiceURL);
        3. optional <AuthnRequest>, for example to signal MFA 
            [SDP-SP07], or ForceAuthn,
        4. Security elements: 
            time stamp
            unique ID (persist)
            optional signature
        5. IdP's SSO destination
    end note
    activate RP
    RP -> Browser: 302 GET idp.edu/sso??SAMLRequest=[request]\nsee [SDP-SP02]\nsee also saml-bindings-2.0-os §3.4
    Browser -> IdP02: GET idp.edu/sso??SAMLRequest=[request]\nwith idp.edu cookies
    activate IdP02
end group

group Validate request
    IdP02 - -> IdP02: validate
    note left
        Minimally ensure SO known and ACS acceptable. Also evaluate whether assurance 
        requests (and any other supported requests) can be honored. Identify steps
        required for identifying the principal.
    end note 
    alt Request cannot be honored
        IdP02 - -> IdP02: construct\nresponse 
        note left
            Construct error response, including the request's unique ID.
            Error should allow SO to assist user in understanding the failure.
        end note 
    end
end
group SAML Profile §4.1.3.4 
    alt Existing SSO state, no assurance
        IdP02 - -> IdP02: construct\nresponse 
        note left
            Construct response as below, including the request's unique ID.
            Error should allow SO to assist user in understanding the failure.
        end note 

    else Existing SSO but ForceAuthn = true
        IdP02 -> Browser: challenge
        Browser -> window
        activate window
        Alice - -> window : respond
        window -> Browser
        destroy window
        Browser -> IdP02
        IdP02 - -> IdP02
        alt Challenge successful
            IdP02 - -> IdP02: response as elsewhere
        else Challenge fails
            IdP02 - -> IdP02: error
        end

    end

    IdP02 -> Browser:  Single Account Label
    note over Browser, IdP02
        SAML IdPs would not expose more than one
        account at a time. The label for the account 
        may not be an email. 
    end note
else Assume no existing SSO state at IdP02
    IdP02 -> Browser: request to initiate authN
end

Browser <-> IdP01: GET client?....
Browser -> IdP02: GET client?client_id=[entityId]&\nSAML_request=[req]

alt Assume IdP recognizes RP
    IdP02 -> Browser: metadata about IdP-RP interaction
     note over Browser, IdP02
        Note that the RP's request might require the 
        browser to step up an already active authentication
        state to improve the authentication assurance.
        The response here would include a message that the
        IdP needs control before authenticating the user.
     end note
else IdP cannot satisfy RP request
    IdP02 -> Browser: Error code, Error message for user
    note over Browser, IdP02
        An IdP might not recognize an RP at all, or the IdP
        might not be able to satisfy criteria in the current 
        RP request.
    end note
end

Browser - -> Browser: IdP chooser
note right
    Assume UI presents the two previously
    registered with a link to choose a 
    different one. If there was an error 
    message for a previously registered 
    IdP, display to the user, but do not 
    allow selection.

    Assume choice between IdP 01 & IdP 02
    or select from more.
end note
Alice - -> Browser: select IDP 02

Browser -> IdP02: cookies; POST assertion
note over Browser, IdP02
    Includes SAMLRequest 
end note

alt Assume active SSO stete, no step up
    IdP02 -> Browser: LARGE XML response, encoded, etc
    destroy window
    Browser -> RP: response\nsession cookie
    destroy Browser
    RP - -> RP: establish\nsession
    RP -> Browser: 302
    Browser <-> Wiki: GET wiki
    Browser - -> window: render wiki
    activate window
else Assume IdP requests control
    [- -> Browser
    activate Browser
    IdP02 -> Browser: HTML
    destroy window
    Browser -> window: Render IdP page
    activate window
    note over Browser, IdP02
        There may be multiple POSTS here, particularly given
        multiple factors to establish identity. It is conceivable
        that this flow may spawn a second authentication
        flow.
    end note
    ...iterations of...
    Alice - -> window: interaction
    window - -> Browser
    Browser <-> IdP02
    ...eventually...
    window -[#red]-> Browser:  n.c.post\n(LARGE XML\nresponse)
    destroy window
    Browser -> RP: response\nsession cookie
    destroy Browser
    RP - -> RP: establish\nsession
    RP -> Browser: 302
    Browser <-> Wiki: GET wiki
    Browser - -> window: render wiki
    activate window
end    


@enduml

PlantUML version 1.2022.7(Mon Aug 22 13:01:30 EDT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>